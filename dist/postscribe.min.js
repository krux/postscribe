/*! Asynchronously write javascript, even with document.write., v2.0.3 https://krux.github.io/postscribe
Copyright (c) 2016 Derek Brans, MIT license https://github.com/krux/postscribe/blob/master/LICENSE */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.postscribe=e():t.postscribe=e()}(this,function(){return function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){(function(e){function n(){}var o=r(1),i=r(4),a=r(3),s=a.isFunction,c=a.toArray,u=a.defaults,p=a.last,f=a.eachKey,l={afterAsync:n,afterDequeue:n,afterStreamStart:n,afterWrite:n,autoFix:!0,beforeEnqueue:n,beforeWriteToken:function(t){return t},beforeWrite:function(t){return t},done:n,error:function(t){throw t},exportEventHandlers:function(t,e){f(t,function(t,r){e[t]=r})},releaseAsync:!1};t.exports=function(){function t(){var t,e=d.shift();e&&(t=p(e),t.afterDequeue(),e.stream=a.apply(null,e),t.afterStreamStart())}function a(e,r,a){function s(t){t=a.beforeWrite(t),y.write(t),a.afterWrite(t)}y=new o(e,a),y.id=h++,y.name=a.name||y.id,f.streams[y.name]=y;var u=e.ownerDocument,p={close:u.close,open:u.open,write:u.write,writeln:u.writeln};i(u,{close:n,open:n,write:function(){return s(c(arguments).join(""))},writeln:function(){return s(c(arguments).join("")+"\n")}});var l=y.win.onerror||n;return y.win.onerror=function(t,e,r){a.error({msg:t+" - "+e+":"+r}),l.apply(y.win,arguments)},y.write(r,function(){i(u,p),y.win.onerror=l,a.done(),y=null,t()}),y}function f(r,o,i){s(i)&&(i={done:i}),i=u(i,l),r=/^#/.test(r)?e.document.getElementById(r.substr(1)):r.jquery?r[0]:r;var a=[r,o,i];return r.postscribe={cancel:function(){a.stream?a.stream.abort():a[1]=n}},i.beforeEnqueue(a),d.push(a),y||t(),r.postscribe}var h=0,d=[],y=null;return i(f,{htmlParser:r(2),streams:{},queue:d,WriteStream:o})}()}).call(e,function(){return this}())},function(t,e,r){var n=r(2),o=r(4),i=r(3),a=i.isFunction,s=i.each,c=i.eachKey,u=i.existy,p=i.toArray,f=i.isScript,l=i.isStyle,h=!1;t.exports=function(){function t(t,e,n){var o=r+e;if(2===arguments.length){var i=t.getAttribute(o);return u(i)?String(i):i}u(n)&&""!==n?t.setAttribute(o,n):t.removeAttribute(o)}function e(e,r){var i=e.ownerDocument;o(this,{root:e,options:r,win:i.defaultView||i.parentWindow,doc:i,parser:n("",{autoFix:r.autoFix}),actuals:[e],proxyHistory:"",proxyRoot:i.createElement(e.nodeName),scriptStack:[],writeQueue:[]}),t(this.proxyRoot,"proxyof",0)}var r="data-ps-";return e.prototype.write=function(){[].push.apply(this.writeQueue,arguments);for(var t;!this.deferredRemote&&this.writeQueue.length;)t=this.writeQueue.shift(),a(t)?this.callFunction(t):this.writeImpl(t)},e.prototype.callFunction=function(t){var e={type:"function",value:t.name||t.toString()};this.onScriptStart(e),t.call(this.win,this.doc),this.onScriptDone(e)},e.prototype.writeImpl=function(t){this.parser.append(t);for(var e,r,n,o=[];(e=this.parser.readToken())&&!(r=f(e))&&!(n=l(e));)e=this.options.beforeWriteToken(e),e&&o.push(e);this.writeStaticTokens(o),r&&this.handleScriptToken(e),n&&this.handleStyleToken(e)},e.prototype.writeStaticTokens=function(t){var e=this.buildChunk(t);if(e.actual)return this.options.exportEventHandlers(e.fns,this.win),e.html=this.proxyHistory+e.actual,this.proxyHistory+=e.proxy,this.proxyRoot.innerHTML=e.html,h&&(e.proxyInnerHTML=this.proxyRoot.innerHTML),this.walkChunk(),h&&(e.actualInnerHTML=this.root.innerHTML),e},e.prototype.buildChunk=function(t){var e=this.actuals.length,o=[],i=[],a=[],c={};return s(t,function(t){var s=n.tokenToString(t,c);if(o.push(s),t.attrs){if(!/^noscript$/i.test(t.tagName)){var u=e++;i.push(s.replace(/(\/?>)/," "+r+"id="+u+" $1")),"ps-script"!==t.attrs.id&&"ps-style"!==t.attrs.id&&a.push("atomicTag"===t.type?"":"<"+t.tagName+" "+r+"proxyof="+u+(t.unary?" />":">"))}}else i.push(s),a.push("endTag"===t.type?s:"")}),{fns:c,tokens:t,raw:o.join(""),actual:i.join(""),proxy:a.join("")}},e.prototype.walkChunk=function(){for(var e,r=[this.proxyRoot];u(e=r.shift());){var n=1===e.nodeType,o=n&&t(e,"proxyof");if(!o){n&&(this.actuals[t(e,"id")]=e,t(e,"id",null));var i=e.parentNode&&t(e.parentNode,"proxyof");i&&this.actuals[i].appendChild(e)}r.unshift.apply(r,p(e.childNodes))}},e.prototype.handleScriptToken=function(t){var e=this.parser.clear();if(e&&this.writeQueue.unshift(e),t.src=t.attrs.src||t.attrs.SRC,t=this.options.beforeWriteToken(t)){t.src&&this.scriptStack.length?this.deferredRemote=t:this.onScriptStart(t);var r=this;this.writeScriptToken(t,function(){r.onScriptDone(t)})}},e.prototype.handleStyleToken=function(t){var e=this.parser.clear();e&&this.writeQueue.unshift(e),t.type=t.attrs.type||t.attrs.TYPE||"text/css",t=this.options.beforeWriteToken(t),t&&this.writeStyleToken(t),e&&this.write()},e.prototype.writeStyleToken=function(t){var e=this.buildStyle(t);this.insertStyle(e),t.content&&(e.styleSheet&&!e.sheet?e.styleSheet.cssText=t.content:e.appendChild(this.doc.createTextNode(t.content)))},e.prototype.buildStyle=function(t){var e=this.doc.createElement(t.tagName);return e.setAttribute("type",t.type),c(t.attrs,function(t,r){e.setAttribute(t,r)}),e},e.prototype.insertStyle=function(t){this.writeImpl('<span id="ps-style"/>');var e=this.doc.getElementById("ps-style");e.parentNode.replaceChild(t,e)},e.prototype.onScriptStart=function(t){t.outerWrites=this.writeQueue,this.writeQueue=[],this.scriptStack.unshift(t)},e.prototype.onScriptDone=function(t){return t!==this.scriptStack[0]?void this.options.error({message:"Bad script nesting or script finished twice"}):(this.scriptStack.shift(),this.write.apply(this,t.outerWrites),void(!this.scriptStack.length&&this.deferredRemote&&(this.onScriptStart(this.deferredRemote),this.deferredRemote=null)))},e.prototype.writeScriptToken=function(t,e){var r=this.buildScript(t),n=this.shouldRelease(r),o=this.options.afterAsync;t.src&&(r.src=t.src,this.scriptLoadHandler(r,n?o:function(){e(),o()}));try{this.insertScript(r),t.src&&!n||e()}catch(i){this.options.error(i),e()}},e.prototype.buildScript=function(t){var e=this.doc.createElement(t.tagName);return c(t.attrs,function(t,r){e.setAttribute(t,r)}),t.content&&(e.text=t.content),e},e.prototype.insertScript=function(t){this.writeImpl('<span id="ps-script"/>');var e=this.doc.getElementById("ps-script");e.parentNode.replaceChild(t,e)},e.prototype.scriptLoadHandler=function(t,e){function r(){t=t.onload=t.onreadystatechange=t.onerror=null}function n(){r(),e()}function i(t){r(),a(t),e()}var a=this.options.error;o(t,{onload:function(){n()},onreadystatechange:function(){/^(loaded|complete)$/.test(t.readyState)&&n()},onerror:function(){i({message:"remote script failed "+t.src})}})},e.prototype.shouldRelease=function(t){var e=/^script$/i.test(t.nodeName);return!e||!!(this.options.releaseAsync&&t.src&&t.hasAttribute("async"))},e}()},function(t,e,r){function n(t,e){t=t||"",e=e||{};for(var r in o)o.hasOwnProperty(r)&&(e.autoFix&&(e["fix_"+r]=!0),e.fix=e.fix||e["fix_"+r]);var n=function(t){return"string"==typeof t&&-1!==t.indexOf("&")&&(t=t.replace("amp;","").replace(/(&#\d{1,4};)/gm,function(t){var e=t.substring(2,t.length-1);return String.fromCharCode(e)})),encodeURI(t)},i=document.createElement("div"),p=function(t){return"string"==typeof t&&-1!==t.indexOf("&")?(i.innerHTML=t,i.textContent||i.innerText||t):t},l=function(e){t+=e},h=function(e){t=e+t},d={comment:/^<!--/,endTag:/^<\//,atomicTag:/^<\s*(script|style|noscript|iframe|textarea)[\s\/>]/i,startTag:/^</,chars:/^[^<]/},y={comment:function(){var e=t.indexOf("-->");return e>=0?{content:t.substr(4,e-1),length:e+3}:void 0},endTag:function(){var e=t.match(s);return e?{tagName:e[1],length:e[0].length}:void 0},atomicTag:function(){var e=y.startTag();if(e){var r=t.slice(e.length);if(r.match(new RegExp("</\\s*"+e.tagName+"\\s*>","i"))){var n=r.match(new RegExp("([\\s\\S]*?)</\\s*"+e.tagName+"\\s*>","i"));if(n)return{tagName:e.tagName,attrs:e.attrs,content:n[1],length:n[0].length+e.length}}}},startTag:function(){var e=t.indexOf(">");if(-1===e)return null;var r=t.match(a);if(r){var o={},i={},s=r[2];return r[2].replace(c,function(t,e){if(arguments[2]||arguments[3]||arguments[4]||arguments[5])if(arguments[5])o[arguments[5]]="",i[e]=!0;else{var r=arguments[2]||arguments[3]||arguments[4]||u.test(e)&&e||"";o[e]="src"===e?n(r):p(r)}else o[e]=null;s=s.replace(t,"")}),{tagName:r[1],attrs:o,booleanAttrs:i,rest:s,unary:!!r[3],length:r[0].length}}},chars:function(){var e=t.indexOf("<");return{length:e>=0?e:t.length}}},m=function(){for(var e in d)if(d[e].test(t)){f&&console.log("suspected "+e);var r=y[e]();return r?(f&&console.log("parsed "+e,r),r.type=r.type||e,r.text=t.substr(0,r.length),t=t.slice(r.length),r):null}},g=function(t){for(var e;e=m();)if(t[e.type]&&t[e.type](e)===!1)return},v=function(){var e=t;return t="",e},T=function(){return t},w=[];return e.fix&&!function(){var r=/^(AREA|BASE|BASEFONT|BR|COL|FRAME|HR|IMG|INPUT|ISINDEX|LINK|META|PARAM|EMBED)$/i,n=/^(COLGROUP|DD|DT|LI|OPTIONS|P|TD|TFOOT|TH|THEAD|TR)$/i;w=[],w.last=function(){return this[this.length-1]},w.lastTagNameEq=function(t){var e=this.last();return e&&e.tagName&&e.tagName.toUpperCase()===t.toUpperCase()},w.containsTagName=function(t){for(var e,r=0;e===this[r];r++)if(e.tagName===t)return!0;return!1};var o=function(t){return t&&"startTag"===t.type&&(t.unary=r.test(t.tagName)||t.unary,t.html5Unary=!/\/>$/.test(t.text)),t},i=m,a=function(){var e=t,r=o(i());return t=e,r},s=function(){var t=w.pop();h("</"+t.tagName+">")},c={startTag:function(t){var r=t.tagName;"TR"===r.toUpperCase()&&w.lastTagNameEq("TABLE")?(h("<TBODY>"),p()):e.fix_selfClose&&n.test(r)&&w.containsTagName(r)?w.lastTagNameEq(r)?s():(h("</"+t.tagName+">"),p()):t.unary||w.push(t)},endTag:function(t){var r=w.last();r?e.fix_tagSoup&&!w.lastTagNameEq(t.tagName)?s():w.pop():e.fix_tagSoup&&u()}},u=function(){i(),p()},p=function(){var t=a();t&&c[t.type]&&c[t.type](t)};m=function(){return p(),o(i())}}(),{append:l,readToken:m,readTokens:g,clear:v,rest:T,stack:w}}var o=function(){var t,e={},r=document.createElement("div");return t="<P><I></P></I>",r.innerHTML=t,e.tagSoup=r.innerHTML!==t,r.innerHTML="<P><i><P></P></i></P>",e.selfClose=2===r.childNodes.length,e}(),i=r(3).escapeQuotes,a=/^<([\-A-Za-z0-9_]+)((?:\s+[\w\-]+(?:\s*=?\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,s=/^<\/([\-A-Za-z0-9_]+)[^>]*>/,c=/(?:([\-A-Za-z0-9_]+)\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))|(?:([\-A-Za-z0-9_]+)(\s|$)+)/g,u=/^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noresize|noshade|nowrap|readonly|selected)$/i,p=/^on[a-z]+/,f=!1;n.supports=o,n.tokenToString=function(t,e){var r={nextName:function(t){return"__psIFX_"+ +new Date+"_"+(99999*Math.random()|0)+"_"+(t||"anon")},push:function(t,r){for(var n=this.nextName(t);e.hasOwnProperty(n);)n=this.nextName(t);return e[n]=new Function(r),n}},n={comment:function(t){return"<!--"+t.content},endTag:function(t){return"</"+t.tagName+">"},atomicTag:function(t){return f&&console.log(t),n.startTag(t)+t.content+n.endTag(t)},startTag:function(t){var e="<"+t.tagName;for(var n in t.attrs){e+=" "+n;var o=t.attrs[n];if("undefined"==typeof t.booleanAttrs||"undefined"==typeof t.booleanAttrs[n])if(p.test(n))try{e+='="'+r.push(n,o)+'.call(this);"'}catch(a){throw new Error("Failed replacing inline event handler with function for "+n+": "+a.message)}else e+='="'+i(o)+'"'}return t.rest&&(e+=t.rest),e+(t.unary&&!t.html5Unary?"/>":">")},chars:function(t){return t.text}};return n[t.type](t)},n.escapeAttributes=function(t){var e={};for(var r in t){var n=t[r];e[r]=i(n)}return e};for(var l in o)n.browserHasFlaw=n.browserHasFlaw||!o[l]&&l;t.exports=n},function(t,e){function r(t){return"function"==typeof t}function n(t,e,r){var n,o=t&&t.length||0;for(n=0;o>n;n++)e.call(r,t[n],n)}function o(t,e,r){var n;for(n in t)t.hasOwnProperty(n)&&e.call(r,n,t[n])}function i(t){return t?t.replace(/(^|[^\\])"/g,'$1\\"'):""}function a(t){return void 0!==t&&null!==t}function s(t,e){return t=t||{},o(e,function(e,r){a(t[e])||(t[e]=r)}),t}function c(t){try{return Array.prototype.slice.call(t)}catch(e){var r=[];return n(t,function(t){r.push(t)}),r}}function u(t){return t[t.length-1]}function p(t){return t&&"tagName"in t?!!~t.tagName.toLowerCase().indexOf("script"):!1}function f(t){return t&&"tagName"in t?!!~t.tagName.toLowerCase().indexOf("style"):!1}t.exports={isFunction:r,each:n,eachKey:o,escapeQuotes:i,existy:a,defaults:s,toArray:c,last:u,isScript:p,isStyle:f}},function(t,e){"use strict";function r(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}var n=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;t.exports=Object.assign||function(t,e){for(var i,a,s=r(t),c=1;c<arguments.length;c++){i=Object(arguments[c]);for(var u in i)n.call(i,u)&&(s[u]=i[u]);if(Object.getOwnPropertySymbols){a=Object.getOwnPropertySymbols(i);for(var p=0;p<a.length;p++)o.call(i,a[p])&&(s[a[p]]=i[a[p]])}}return s}}])});